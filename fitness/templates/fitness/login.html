{% extends 'fitness/layout.html' %}
{% load static %}

{% block content %}
<div class="container form-container">
    <div class="login-card">
        <h2 class="login-title">Iniciar Sesión</h2>
        <p class="login-subtitle">Ingresa tus credenciales para acceder</p>

        <!-- Mostrar mensajes de Django -->
         <h1>{{title}}</h1>
        {% if messages %}
            {% for message in messages %}
                <div class="alert alert-warning {% if message.tags == 'error' %}danger{% else %}{{ message.tags }}{% endif %} alert-dismissible fade show" role="alert">
                    {{ message }}
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
            {% endfor %}
        {% endif %}

        <form method="POST" id="loginForm" action="{% url 'login' %}">
            {% csrf_token %}
            <input type="hidden" name="next" value="{% url 'consejos' %}">
            
            <div class="form-group">
                <label for="username" class="form-label">Nombre de Usuario</label>
                <div class="input-group">
                    <span class="input-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-person" viewBox="0 0 16 16">
                            <path d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6Zm2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0Zm4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4Zm-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10c-2.29 0-3.516.68-4.168 1.332-.678.678-.83 1.418-.832 1.664h10Z"/>
                        </svg>
                    </span>
                    <input type="text" class="form-control custom-width" id="username" name="username" placeholder="Ingresa tu nombre de usuario" required>
                </div>
            </div>
            
            <div class="form-group">
                <label for="password" class="form-label">Contraseña</label>
                <div class="input-group">
                    <span class="input-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-lock" viewBox="0 0 16 16">
                            <path d="M8 1a2 2 0 0 1 2 2v4H6V3a2 2 0 0 1 2-2zm3 6V3a3 3 0 0 0-6 0v4a2 2 0 0 0-2 2v5a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2zM5 8h6a1 1 0 0 1 1 1v5a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V9a1 1 0 0 1 1-1z"/>
                        </svg>
                    </span>
                    <input type="password" class="form-control custom-width" id="password" name="password" placeholder="Ingresa tu contraseña" required>
                </div>
            </div>
            
            <div class="form-options">
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" value="" id="rememberMe">
                    <label class="form-check-label" for="rememberMe">
                        Recordarme
                    </label>
                </div>
            </div>
            
            <div class="button-group">
                <button type="button" id="volverBtn" class="btn btn-secondary">Volver al Inicio</button>
                <button type="submit" class="btn btn-primary" id="btnEnviar">
                    <i class="fas fa-sign-in-alt me-2"></i>Iniciar Sesión
                </button>
            </div>
        </form>
        
        <div class="login-footer">
            <p>¿No tienes una cuenta? <a href="{% url 'Registro' %}" class="signup-link">Regístrate aquí</a></p>
        </div>
    </div>
</div>

<!-- Scripts -->
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<script>
    $(document).ready(function() {
    $('#volverBtn').click(function() {
        window.location.href = "{% url 'index' %}";
    });

    $('#loginForm').on('submit', function() {
        var username = $('#username').val();
        var password = $('#password').val();

        if (username === '' || password === '') {
            Swal.fire({
                icon: 'warning',
                title: '¡Atención!',
                text: 'Por favor, completa todos los campos.'
            });
            return false;
        }

        // Mostrar animación de carga
        Swal.fire({
            title: 'Iniciando sesión...',
            text: 'Esto tomará unos momentos',
            allowOutsideClick: false,
            showConfirmButton: false,
            didOpen: () => {
                Swal.showLoading();
            }
        });
    });
});

</script>
{% endblock %}